## Описание проекта

Компания «ГлавРосГосНефть» планирует увеличить объём добычи нефти. Нужно решить, где бурить новую скважину.

В нашем распоряжении данные о пробах нефти в трёх регионах: в каждом 10 000 месторождений, где измерили качество нефти и объём её запасов.

Шаги для выбора локации:

* В избранном регионе ищут месторождения, для каждого определяют значения признаков;
* Строят модель и оценивают объём запасов;
* Выбирают месторождения с самым высокими оценками значений. Количество месторождений зависит от бюджета компании и стоимости разработки одной скважины;
* Прибыль равна суммарной прибыли отобранных месторождений.

*Цель исследования* - построить модель машинного обучения, которая поможет определить регион, где добыча принесёт наибольшую прибыль.

*Задачи исследования:*

- исследовать входные и целевой признаки;
- провести корреляционный анализ;
- создать модель, которая будет прогнозировать объём запасов в скважине для каждого региона;
- рассчитать достаточный объём сырья для безубыточной разработки новой скважины;
- оценить риски и прибыль для каждого региона с учётом предсказаний модели;
- предложить регион для разработки скважин.

*Условия задачи:*

* Для обучения модели подходит только линейная регрессия (остальные — недостаточно предсказуемые).
* При разведке региона исследуют 500 точек, из которых с помощью машинного обучения выбирают 200 лучших для разработки.
* Бюджет на разработку скважин в регионе — 10 млрд рублей.
* При нынешних ценах один баррель сырья приносит 450 рублей дохода. Доход с каждой единицы продукта составляет 450 тыс. рублей, поскольку объём указан в тысячах баррелей.
* После оценки рисков нужно оставить лишь те регионы, в которых вероятность убытков меньше 2.5%. Среди них выбирают регион с наибольшей средней прибылью.

*Ход исследования:*

В начале подготовим данные: проверим датасеты на наличие полных и неявных дубликатов, подсчитаем пропуски в данных и проверим соответствие значений в столбцах их типам.

Далее проведём исследовательский анализ данных. Построим графики с распределением и числовым размахом для каждой переменной, попробуем выявить выбросы. Перед построением модели необходимо будет провести корреляционный анализ: построить матрицу корреляций для целевого и входных признаков, оценить наличие мультиколлинеарности.

Потом приступим к построению пайплайна. Для масштабирования количественных признаков используем несколько скейлеров. Для обучения выберем 3 модели линейной регрессии (LinearRegression, Ridge, Lasso) подберём для них гиперпараметры с помощью RandomizedSearchCV. В результате выберем лучшую модель по метрике RMSE. Определим средний запас предсказанного сырья для каждого региона и сравним с показателем объёма сырья для безубыточной разработки новой скважины. Напишем функцию для расчёта прибыли, учитывая скважины с максимальными значениями предсказаний. Затем посчитаем риски и прибыль для каждого региона, используя технику Bootstrap. Сформулируем итоговый вывод и выберем регион с наименьшим риском отрицательной прибыли и наибольшей средней прибылью.

## Описание данных

Данные геологоразведки для трёх регионов:

* id — уникальный идентификатор скважины;
* f0, f1, f2 — три признака точек (неважно, что они означают, но сами признаки значимы);
* product — объём запасов в скважине (тыс. баррелей).

## Библиотеки:

* Pandas
* Seaborn
* Matplotlib
* Numpy
* SciPy
* Sklearn
* Statsmodels
* Math
* Optuna
